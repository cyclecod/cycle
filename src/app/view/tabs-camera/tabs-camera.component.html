<!--
 * @Author: 九阳
 * @Date: 2022-07-28 14:15:07
 * @LastEditors: 九阳
 * @LastEditTime: 2022-10-24 14:54:47
-->

<ng-container *ngIf="isChoose === 'danger-add'">
<div class="ml-title-bg">
  <div class="ml-title">隐患填报</div>
  <!-- <div class="ml-title-button"></div> -->
</div>
<Tabs [page]="2" [useOnPan]="true" [swipeable]="true" [activeTab]="pageIndex" [tabBarActiveTextColor]="'#1890ff'"
  (onTabClick)="onTabClick($event)">
  <TabPane [title]="'双重预防隐患填报'">
    <div class="ml-interval"></div>
    <List class="item-position">
      <InputItem placeholder="请输入隐患名称" [(ngModel)]="objectData.dangerName" [content]="'隐患名称'">
      </InputItem>

      <InputItem placeholder="请选择隐患类型" [editable]="false"
        (click)="showPicker('shyf.hazardDangerType', 'hazardDangerType')" [value]="selectData.hazardDangerType"
        [content]="'隐患类型'">
      </InputItem>

      <InputItem placeholder="请选择隐患等级" [editable]="false" (click)="showPicker('shyf.dangerLevel', 'dangerLevel')"
        [value]="selectData.dangerLevel" [content]="'隐患等级'">
      </InputItem>

      <InputItem placeholder="请选择隐患来源" [editable]="false" (click)="showPicker('shyf.dangerSrc', 'dangerSrc')"
        [value]="selectData.dangerSrc" [content]="'隐患来源'">
      </InputItem>

      <TextareaItem placeholder="请输隐患描述" [(ngModel)]="objectData.dangerDesc" [clear]="true" [title]="'隐患描述'"
        [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>

      <InputItem placeholder="请选择治理类型" [editable]="false"
        (click)="showPicker('shyf.dangerManageType', 'dangerManageType')" [value]="selectData.dangerManageType"
        [content]="'治理类型'">
      </InputItem>

      <TextareaItem placeholder="请输形成原因" [(ngModel)]="objectData.dangerReason" [clear]="true" [title]="'形成原因'"
        [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>

      <TextareaItem placeholder="请输管控措施" [(ngModel)]="objectData.controlMeasures" [clear]="true" [title]="'管控措施'"
        [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>

      <ListItem DatePicker [extra]="getTime(dangerManageDeadline)" [arrow]="'horizontal'" [mode]="'date'"
        [(ngModel)]='dangerManageDeadline' placeholder="请选择计划完成时间">
        计划完成时间
      </ListItem>
      <InputItem placeholder="请选择装置" (click)="returnBack('choose-device')" required [editable]="false"
        [value]="objectData.deviceName" [content]="'装置名称'">
      </InputItem>
      <InputItem placeholder="请选择单元" (click)="returnBack('choose-unit')" required [editable]="false"
        [value]="objectData.unitName" [content]="'单元名称'">
      </InputItem>
      <InputItem placeholder="请选择整改人员" (click)="returnBack('choose-department')" required [editable]="false"
        [value]="objectData.liablePersonId" [content]="'整改人名称'">
    </InputItem>
      <div class="ml-interval"></div>
      <ml-gray-bar [data]="'附件信息'"></ml-gray-bar>
      <ph-image #phImage [isEdit]="true" [fileList]="fileList"></ph-image>
      <ml-gray-bar></ml-gray-bar>
    </List>
    <div Button [type]="'primary'" style="margin: 10px;margin-left: 50px;margin-right: 50px;" class="button"
      debounceClick [debounceTime]="300" (debounceClick)="onSave()">提交
    </div>
  </TabPane>





  <TabPane [title]="'自定义隐患填报'">
    <div class="ml-interval"></div>
    <List class="item-position">
      <InputItem placeholder="请输入隐患名称" [(ngModel)]="customObjectData.dangerName" [content]="'隐患名称'">
      </InputItem>

      <InputItem placeholder="隐患等级" [editable]="false" (click)="showPicker1('dangerLevel', 'dangerLevel')"
        [value]="selectData.dangerLevel" [content]="'隐患等级'">
      </InputItem>

      <InputItem placeholder="所属工厂" [editable]="false" (click)="showPicker1('factoryInfo', 'factoryId')"
        [value]="selectData.factoryId" [content]="'所属工厂'">
      </InputItem>

      <InputItem placeholder="所属区域" [editable]="false" (click)="showPicker1('areaInfo', 'areaId')"
        [value]="selectData.areaId" [content]="'所属区域'">
      </InputItem>

      <!-- <TextareaItem placeholder="排查类型" [(ngModel)]="customObjectData.planName" [clear]="true" [title]="'排查类型'"
        [editable]="false" [autoHeight]="true" [labelNumber]="2">
      </TextareaItem> -->

      <InputItem placeholder="请选择参与排查人" (click)="returnBack('choose-department')" required [editable]="false"
        [value]="customObjectData.checkHelperName" [content]="'参与排查人'">
      </InputItem>

      <InputItem placeholder="班组" [(ngModel)]="customObjectData.team" [content]="'班组'">
      </InputItem>

      <InputItem placeholder="隐患一级分类" [editable]="false"
        (click)="showPicker1('dangerFirstCategory', 'dangerFirstCategory')" [value]="selectData.dangerFirstCategory"
        [content]="'隐患一级分类'">
      </InputItem>

      <InputItem placeholder="隐患二级分类" [editable]="false"
        (click)="showPicker1('dangerSecondCategory', 'dangerSecondCategory')" [value]="selectData.dangerSecondCategory"
        [content]="'隐患二级分类'">
      </InputItem>


      <TextareaItem placeholder="二级分类说明" [(ngModel)]="customObjectData.typeDesc" [clear]="true" [title]="'二级分类说明'"
        [editable]="false" [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>



      <TextareaItem placeholder="隐患描述" [(ngModel)]="customObjectData.dangerDesc" [clear]="true" [title]="'隐患描述'"
        [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>

      <!-- <InputItem placeholder="形成原因"
      (click)="showPicker('dangerCauseReason', 'dangerCauseReason')" [value]="selectData.dangerCauseReason"
      [content]="'形成原因'">
    </InputItem> -->

      <List renderHeader="形成原因" class="jzy-checkBox">
        <CheckboxItem *ngFor="let i of codeValueList.dangerCauseReason" [name]="i.itemCname" [value]="i.itemCode"
          [(ngModel)]="i.checked">
          {{ i.itemCname }}
        </CheckboxItem>
      </List>

      <InputItem placeholder="治理类型" [editable]="false" (click)="showPicker1('dangerManageType', 'dangerManageType')"
        [value]="selectData.dangerManageType" [content]="'治理类型'">
      </InputItem>

      <TextareaItem placeholder="建议整改措施" [(ngModel)]="customObjectData.dangerControlMeasures" [clear]="true"
        [title]="'建议整改措施'" [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>

      <TextareaItem placeholder="现场整改措施" [(ngModel)]="customObjectData.dangerMeasuresNow" [clear]="true" [title]="'现场整改措施'"
        [autoHeight]="true" [labelNumber]="2">
      </TextareaItem>


      <div class="ml-interval"></div>
      <ml-gray-bar [data]="'附件信息'"></ml-gray-bar>
      <ph-image #phImage [isEdit]="true" [fileList]="fileList"></ph-image>
      <ml-gray-bar></ml-gray-bar>
    </List>
    <div Button [type]="'primary'" style="margin: 10px;margin-left: 50px;margin-right: 50px;" class="button"
      debounceClick [debounceTime]="300" (debounceClick)="customOnSave()">提交
    </div>

  </TabPane>
</Tabs>
</ng-container>




    <!-- 选择装置-->
    <ng-container *ngIf="isChoose === 'choose-device'">
      <ph-choose-device [(isUse)]="isChoose" (chooseData)="chooseData($event, 'choose-device')"></ph-choose-device>
    </ng-container>
    <!-- 选择单元-->
    <ng-container *ngIf="isChoose === 'choose-unit'">
      <ph-choose-unit [deviceBasicId]="objectData.deviceId" [(isUse)]="isChoose"(chooseData)="chooseData($event, 'choose-unit')">
    </ph-choose-unit>
    </ng-container>
      <!-- 选择整改人员-->
    <ng-container *ngIf="isChoose === 'choose-department'">
      <ph-choose-department [unitBasicId]="objectData.unitId" [(isUse)]="isChoose" (chooseData)="chooseData($event, 'choose-department')">
      </ph-choose-department>
    </ng-container>

    <!-- <ng-container *ngIf="isChoose === 'choose-depart'">
      <ph-choose-department [unitBasicId]="objectData.unitId" [(isUse)]="isChoose" (chooseData)="chooseData($event, 'choose-depart')">
      </ph-choose-department>
    </ng-container> -->



